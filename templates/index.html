<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prédiction Assurance</title>
</head>
<body>
    <h2>Entrez les informations pour prédire les charges d'assurance</h2>
    <form id="predictionForm">
        <label for="age">Âge :</label>
        <input type="number" id="age" name="age" required><br><br>

        <label for="sex">Sexe :</label>
        <select id="sex" name="sex" required>
            <option value="male">male</option>
            <option value="female">female</option>
        </select><br><br>

        <label for="bmi">IMC :</label>
        <input type="number" id="bmi" name="bmi" step="0.1" required><br><br>

        <label for="children">Nombre d'enfants :</label>
        <input type="number" id="children" name="children" required><br><br>

        <label for="smoker">Fumeur :</label>
        <select id="smoker" name="smoker" required>
            <option value="yes">yes</option>
            <option value="no">no</option>
        </select><br><br>

        <label for="region">Région :</label>
        <select id="region" name="region" required>
            <option value="southeast">Southeast</option>
            <option value="southwest">Southwest</option>
            <option value="northwest">Northwest</option>
            <option value="northeast">Northeast</option>
        </select><br><br>

        <button type="button" onclick="sendPrediction()">Obtenir la prédiction</button>
    </form>

    <h3 id="result"></h3>

    <script>
        async function sendPrediction() {
            const data = {
                age: parseFloat(document.getElementById('age').value),
                sex: document.getElementById('sex').value,
                bmi: parseFloat(document.getElementById('bmi').value),
                children: parseInt(document.getElementById('children').value),
                smoker: document.getElementById('smoker').value,
                region: document.getElementById('region').value
            };

            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                if (response.ok) {
                    document.getElementById('result').innerText = "Prédiction des charges : " + result.resultats.prediction;
                } else {
                    document.getElementById('result').innerText = "Erreur : " + result.erreur;
                }
            } catch (error) {
                console.error("Erreur lors de la prédiction :", error);
                document.getElementById('result').innerText = "Erreur lors de la prédiction.";
            }
        }
    </script>
</body>
</html>
